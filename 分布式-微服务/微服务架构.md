## 微服务架构

微服务架构简单模式可以暂且不用关注保障数据一致性的分布式事务技术、方便程序包在环境间（开发、测试、生产）迁移的配置中心组件、监控 `API `调用情况的调用链组件、避免系统超载的断路器组件、方便 `API` 管理和测试的 `API` 文档框架、`Zookeeper`、`Redis`，以及各种 `MQ`。只需要关注常常谈到的 **注册中心**、**服务发现**、**负载均衡**和 **服务网关**即可。

**架构图**

![图1](C:\Users\LENOVO\Desktop\图1.png)

![图2](C:\Users\LENOVO\Desktop\图2.png)

一般**同步调用**比较简单，一致性强，但是容易出调用问题，性能体验上也会差些，特别是调用层次多的时候。一般REST基于HTTP，更容易实现，更容易被接受，服务端实现技术也更灵活些，各个语言都能支持，同时能跨客户端，对客户端没有特殊的要求，只要封装了HTTP的SDK就能调用，所以相对使用的广一些。RPC传输协议更高效，安全更可控，特别在一个公司内部，如果有统一个 的开发规范和统一的服务框架时，他的开发效率优势更明显些。而**异步消息**的方式在分布式系统中有特别广泛的应用，他既能**减低调用服务之间的耦合**，又能成为调用之间的缓冲，**确保消息积压不会冲垮被调用方**，同时能**保证调用方的服务体验**，继续干自己该干的活，不至于被后台性能拖慢。不过需要付出的代价是一致性的减弱，需要接受**数据最终一致性**；还有就是后台服务一般要 **实现幂等性**，因为消息发送出于性能的考虑一般会有重复（**保证消息的被收到且仅收到一次**对性能是很大的考验）；最后就是必须引入一个独立的broker，如 果公司内部没有技术积累，对broker分布式管理也是一个很大的挑战。

**同步调用**

- 比较简单，一致性强
- 容易出调用问题，性能体验上也会差些

**异步消息**

- 广泛应用于分布式系统中
- 降低调用服务之间的耦合
- 调用之间的缓冲，**确保消息积压不会冲垮被调用方**
- 能**保证调用方的服务体验**
- 需要接受**数据最终一致性**